<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocol Control | Admin Access</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;700&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Cairo', 'sans-serif'],
                        tech: ['Orbitron', 'sans-serif'],
                        mono: ['Rajdhani', 'monospace'],
                    },
                    colors: {
                        cyber: {
                            black: '#030508',
                            dark: '#0a0f16',
                            primary: '#00f2ff',
                            secondary: '#bc13fe',
                            accent: '#f7931e',
                            danger: '#ff2a6d'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #030508;
            color: #e2e8f0;
            font-family: 'Cairo', sans-serif;
            background-image:
                radial-gradient(circle at 50% 50%, rgba(0, 242, 255, 0.05) 0%, transparent 50%),
                linear-gradient(rgba(0, 242, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 242, 255, 0.03) 1px, transparent 1px);
            background-size: 100% 100%, 30px 30px, 30px 30px;
        }

        .glass-panel {
            background: rgba(10, 15, 22, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 242, 255, 0.1);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .control-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .control-btn.active {
            border-color: var(--color-active);
            background: linear-gradient(90deg, rgba(0, 0, 0, 0) 0%, var(--bg-active) 100%);
            box-shadow: inset 0 0 20px var(--bg-active);
        }

        h1,
        h2 {
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Scanning line animation */
        .scan-line {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: #00f2ff;
            opacity: 0.3;
            animation: scan 4s linear infinite;
            pointer-events: none;
            z-index: 999;
        }

        @keyframes scan {
            0% {
                transform: translateY(-100vh);
            }

            100% {
                transform: translateY(100vh);
            }
        }
    </style>
</head>

<body class="min-h-screen p-6">

    <div class="scan-line"></div>

    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="flex justify-between items-center mb-10 border-b border-cyber-primary/20 pb-6">
            <h1 class="text-3xl font-bold text-cyber-primary flex items-center gap-4 glow-text">
                <i class="fas fa-terminal"></i> COMMAND CENTER
            </h1>
            <div
                class="flex items-center gap-3 text-xs bg-cyber-black/80 px-4 py-2 rounded border border-cyber-primary/30 font-mono tracking-widest text-cyber-primary">
                <span class="w-2 h-2 bg-cyber-primary rounded-full animate-pulse shadow-[0_0_10px_#00f2ff]"></span>
                SYSTEM ONLINE
            </div>
        </div>

        <!-- Status Card -->
        <div class="glass-panel p-8 rounded-xl mb-10 relative overflow-hidden group">
            <div
                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition text-6xl text-cyber-primary">
                <i class="fas fa-network-wired"></i></div>
            <h2 class="text-sm font-bold mb-6 text-gray-400 font-mono uppercase tracking-widest">Global Protocol Status
            </h2>
            <div id="current-status"
                class="text-center p-8 bg-black/40 rounded border border-dashed border-gray-700 text-gray-300 text-2xl font-tech tracking-wider transition-all duration-500">
                <i class="fas fa-circle-notch fa-spin mr-3 text-sm"></i> FETCHING DATA...
            </div>
        </div>

        <!-- Control Panel -->
        <h2 class="text-xl font-bold mb-6 text-white flex items-center gap-2">
            <i class="fas fa-sliders-h text-cyber-accent"></i> OVERRIDE CONTROLS
        </h2>

        <div class="grid md:grid-cols-3 gap-6">

            <!-- Option 1: Let Users Choose -->
            <button onclick="setMission('SELECTION_MODE')" id="btn-SELECTION_MODE"
                class="control-btn group relative flex flex-col items-center p-6 rounded-xl hover:border-cyber-primary"
                style="--color-active: #00f2ff; --bg-active: rgba(0, 242, 255, 0.1);">
                <div
                    class="w-16 h-16 bg-cyber-primary/10 rounded-full flex items-center justify-center text-cyber-primary mb-4 group-hover:scale-110 transition-transform shadow-[0_0_15px_rgba(0,242,255,0.2)]">
                    <i class="fas fa-users text-2xl"></i>
                </div>
                <div class="text-center">
                    <h3 class="font-bold text-lg text-white font-tech mb-2">FREE MODE</h3>
                    <p class="text-xs text-gray-400 font-mono">Agents select protocol manually.</p>
                </div>
                <div class="absolute top-4 right-4 text-cyber-primary opacity-0 check-icon transition-all"><i
                        class="fas fa-check-circle"></i></div>
            </button>

            <!-- Option 2: Force Sam Altman -->
            <button onclick="setMission('mission_sam')" id="btn-mission_sam"
                class="control-btn group relative flex flex-col items-center p-6 rounded-xl hover:border-cyber-accent"
                style="--color-active: #f7931e; --bg-active: rgba(247, 147, 30, 0.1);">
                <div
                    class="w-16 h-16 bg-cyber-accent/10 rounded-full flex items-center justify-center text-cyber-accent mb-4 group-hover:scale-110 transition-transform shadow-[0_0_15px_rgba(247,147,30,0.2)]">
                    <i class="fas fa-robot text-2xl"></i>
                </div>
                <div class="text-center">
                    <h3 class="font-bold text-lg text-white font-tech mb-2">FORCE: SAM</h3>
                    <p class="text-xs text-gray-400 font-mono">Override all agents to 'Mystery 1'.</p>
                </div>
                <div class="absolute top-4 right-4 text-cyber-accent opacity-0 check-icon transition-all"><i
                        class="fas fa-check-circle"></i></div>
            </button>

            <!-- Option 3: Force Alan Turing -->
            <button onclick="setMission('mission_turing')" id="btn-mission_turing"
                class="control-btn group relative flex flex-col items-center p-6 rounded-xl hover:border-cyber-secondary"
                style="--color-active: #bc13fe; --bg-active: rgba(188, 19, 254, 0.1);">
                <div
                    class="w-16 h-16 bg-cyber-secondary/10 rounded-full flex items-center justify-center text-cyber-secondary mb-4 group-hover:scale-110 transition-transform shadow-[0_0_15px_rgba(188,19,254,0.2)]">
                    <i class="fas fa-code text-2xl"></i>
                </div>
                <div class="text-center">
                    <h3 class="font-bold text-lg text-white font-tech mb-2">FORCE: TURING</h3>
                    <p class="text-xs text-gray-400 font-mono">Override all agents to 'Mystery 2'.</p>
                </div>
                <div class="absolute top-4 right-4 text-cyber-secondary opacity-0 check-icon transition-all"><i
                        class="fas fa-check-circle"></i></div>
            </button>

        </div>

        <!-- Footer -->
        <div
            class="mt-12 text-center text-gray-600 text-xs font-mono uppercase tracking-widest border-t border-gray-800 pt-6">
            SECURE CONNECTION TO INDABAX SERVER ESTABLISHED
        </div>

        <!-- Feedback Toast -->
        <div id="toast"
            class="fixed bottom-10 right-10 bg-cyber-primary/90 text-black px-6 py-4 rounded border-l-4 border-white shadow-[0_0_30px_rgba(0,242,255,0.4)] hidden transition-all translate-y-10 opacity-0 flex items-center gap-4 z-50 backdrop-blur">
            <i class="fas fa-check-square text-xl"></i> <span class="font-bold font-mono">PROTOCOL UPDATED
                SUCCESSFULLY</span>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDTuocX-lCYRMrgFQLnSzKcpnQnL2sLHs0",
            authDomain: "ai-cipher-hunt-p2.firebaseapp.com",
            projectId: "ai-cipher-hunt-p2",
            storageBucket: "ai-cipher-hunt-p2.firebasestorage.app",
            messagingSenderId: "539746998922",
            appId: "1:539746998922:web:579ec59bc94a0a4d9aab73",
            measurementId: "G-ENP1QLMEKD"
        };

        const APP_ID = typeof __app_id !== 'undefined' ? __app_id : firebaseConfig.projectId;

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        const configDocRef = doc(db, "artifacts", APP_ID, "public", "data", "game_config", "status");

        async function init() {
            try {
                await signInAnonymously(auth);
                onSnapshot(configDocRef, (docSnap) => {
                    if (docSnap.exists()) {
                        updateUI(docSnap.data().active_mission_id);
                    } else {
                        updateUI('SELECTION_MODE');
                    }
                }, (error) => {
                    console.error("Error listening to config:", error);
                    const st = document.getElementById('current-status');
                    st.innerText = "LINK FAILURE: " + error.message;
                    st.classList.add('text-cyber-danger', 'border-cyber-danger');
                });
            } catch (e) {
                console.error("Auth Error:", e);
            }
        }

        function updateUI(activeId) {
            const statusEl = document.getElementById('current-status');

            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.querySelector('.check-icon').style.opacity = '0';
            });

            let text = "UNKNOWN";
            let colorClass = "text-gray-400 border-gray-600";
            let glow = "none";

            if (activeId === 'SELECTION_MODE') {
                text = "STATUS: FREE SELECTION";
                colorClass = "text-cyber-primary border-cyber-primary";
                glow = "0 0 15px rgba(0, 242, 255, 0.2)";
                activateBtn('btn-SELECTION_MODE');
            } else if (activeId === 'mission_sam') {
                text = "STATUS: PROTOCOL SAM (LOCKED)";
                colorClass = "text-cyber-accent border-cyber-accent";
                glow = "0 0 15px rgba(247, 147, 30, 0.2)";
                activateBtn('btn-mission_sam');
            } else if (activeId === 'mission_turing') {
                text = "STATUS: PROTOCOL TURING (LOCKED)";
                colorClass = "text-cyber-secondary border-cyber-secondary";
                glow = "0 0 15px rgba(188, 19, 254, 0.2)";
                activateBtn('btn-mission_turing');
            }

            statusEl.innerHTML = `<i class="fas fa-broadcast-tower mr-3"></i> ${text}`;
            statusEl.className = `text-center p-8 bg-black/40 rounded border-2 font-tech text-2xl tracking-wider transition-all duration-300 ${colorClass}`;
            statusEl.style.boxShadow = glow;
        }

        function activateBtn(btnId) {
            const btn = document.getElementById(btnId);
            if (btn) {
                btn.classList.add('active');
                btn.querySelector('.check-icon').style.opacity = '1';
            }
        }

        window.setMission = async (missionId) => {
            const btn = document.getElementById('btn-' + missionId);
            if (btn) btn.style.opacity = '0.5';

            try {
                await setDoc(configDocRef, {
                    active_mission_id: missionId,
                    updated_at: new Date().toISOString(),
                    updated_by: auth.currentUser ? auth.currentUser.uid : 'unknown'
                });
                showToast();
            } catch (error) {
                console.error("Error setting mission:", error);
                alert("ERROR: " + error.message);
            } finally {
                if (btn) btn.style.opacity = '1';
            }
        };

        function showToast() {
            const t = document.getElementById('toast');
            t.classList.remove('hidden');
            setTimeout(() => { t.classList.remove('translate-y-10', 'opacity-0'); }, 10);
            setTimeout(() => {
                t.classList.add('translate-y-10', 'opacity-0');
                setTimeout(() => t.classList.add('hidden'), 300);
            }, 3000);
        }

        init();
    </script>
</body>

</html>